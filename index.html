<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Ecclesia IEC Prototype</title>
  <!-- Google Fonts: Montserrat -->
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link 
    href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" 
    rel="stylesheet"
  >
  <style>
    /* ---------- Global Reset & Typography ---------- */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Montserrat', sans-serif;
      background: #E5E9F7; /* Softer background */
      color: #333;
      min-height: 100vh;
      position: relative;
      padding-bottom: 70px; /* room for bottom nav */
    }
    h1, h2, h3 {
      color: #2B59C3; /* Primary accent color */
      margin-bottom: 10px;
    }
    p {
      color: #555;
      margin-bottom: 6px;
    }
    a {
      color: #2B59C3;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }

    /* ---------- Header Bar ---------- */
    .app-header {
      background: #fff;
      padding: 15px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
      text-align: center;
      position: sticky;
      top: 0;
      z-index: 150;
    }
    .app-header h1 {
      font-size: 1.3rem;
      margin: 0;
    }

    /* ---------- Mobile Container & Views ---------- */
    .view {
      display: none;
      padding: 15px;
    }
    .active {
      display: block;
    }

    /* ---------- Main Container Cards ---------- */
    .container {
      background: #fff;
      border-radius: 8px;
      padding: 15px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      margin-bottom: 15px;
    }

    /* ---------- Bottom Navigation ---------- */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 120px;
      background: #fff;
      border-top: 1px solid #ccc;
      display: flex;
      justify-content: space-around;
      align-items: center;
      z-index: 100;
    }
    .bottom-nav button {
      background: none;
      border: none;
      color: #666;
      font-size: 1.2rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      cursor: pointer;
    }
    .bottom-nav button.active {
      color: #2B59C3;
      font-weight: 700;
    }
    .bottom-nav button svg {
      width: 24px;
      height: 24px;
      margin-bottom: 3px;
    }

    /* ---------- Button Styling ---------- */
    .btn {
      display: inline-block;
      padding: 10px 20px;
      background: #2B59C3;
      color: #fff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.3s;
      margin: 5px 0;
      font-size: 0.9rem;
    }
    .btn:hover {
      background: #1f479c;
    }

    /* ---------- Election Block ---------- */
    .election-block {
      border: 1px solid #ddd;
      border-radius: 6px;
      padding: 12px;
      margin-bottom: 10px;
      background: #FAFAFF;
      transition: background 0.2s, transform 0.2s;
      cursor: pointer;
    }
    .election-block:hover {
      transform: translateY(-2px);
      background: #f0f0ff;
    }
    .election-block h2 {
      font-size: 1.1rem;
      margin-bottom: 8px;
    }

    /* ---------- Position Block ---------- */
    .position-block {
      margin-bottom: 15px;
    }
    .position-info {
      margin-bottom: 10px;
    }
    .position-info h2 {
      font-size: 1rem;
      margin-bottom: 6px;
    }
    .position-nav {
      margin-top: 10px;
      display: flex;
      gap: 10px;
    }

    /* ---------- Candidate Blocks ---------- */
    .candidates {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      justify-content: flex-start;
    }
    .candidate-block {
      border: 1px solid #ddd;
      padding: 10px;
      border-radius: 6px;
      width: 120px;
      text-align: center;
      position: relative;
      cursor: pointer;
      background: #fff;
      transition: box-shadow 0.2s, transform 0.2s;
    }
    .candidate-block:hover {
      box-shadow: 0 3px 8px rgba(0,0,0,0.1);
      transform: translateY(-2px);
    }
    .candidate-block img {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      margin-bottom: 5px;
      border: 1px solid #ccc;
      object-fit: cover;
    }
    .candidate-block p {
      font-size: 0.85rem;
      font-weight: 500;
      color: #333;
    }
    .best-choice {
      position: absolute;
      top: 5px;
      right: 5px;
      background: #2B59C3;
      color: #fff;
      border-radius: 50%;
      padding: 2px 5px;
      font-size: 0.7rem;
      font-weight: bold;
    }

    /* ---------- Candidate Panel (Overlay) ---------- */
    .overlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.6);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 200;
      padding: 15px;
    }
    .overlay.active {
      display: flex;
    }
    .candidate-panel {
      background: #fff;
      border-radius: 6px;
      padding: 15px;
      max-width: 600px;
      width: 100%;
      position: relative;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    .candidate-panel img {
      width: 100%;
      max-height: 220px;
      object-fit: cover;
      border-radius: 6px;
      margin-bottom: 10px;
    }
    .candidate-panel h2 {
      font-size: 1.1rem;
      margin-bottom: 8px;
      color: #2B59C3;
    }
    .close-panel {
      position: absolute;
      top: 10px;
      right: 10px;
      background: transparent;
      border: none;
      font-size: 1.5rem;
      color: #333;
      cursor: pointer;
    }
    .social-links a {
      margin-right: 10px;
      font-size: 0.9rem;
      color: #2B59C3;
    }

    /* ---------- Reward Panel ---------- */
    .reward-panel {
      background: #fff;
      padding: 15px;
      border-radius: 6px;
      text-align: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    /* ---------- Read-only Summary ---------- */
    .summary-block {
      border: 1px solid #ddd;
      border-radius: 6px;
      padding: 10px;
      background: #FAFAFF;
      margin-bottom: 10px;
    }
    .summary-block h3 {
      margin-bottom: 6px;
      color: #2B59C3;
    }

    /* ---------- Profile (Ecco) View ---------- */
    #profileView .profile-info {
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
    }
    #profileView .profile-info .avatar-wrapper {
      position: relative;
      width: 120px;
      height: 120px;
      margin-bottom: 10px;
    }
    #profileView .profile-info .avatar-wrapper .avatar-bg {
      background: linear-gradient(135deg, #2B59C3, #4D79EC);
      width: 100%;
      height: 100%;
      border-radius: 50%;
      position: absolute;
      top: 0;
      left: 0;
    }
    #profileView .profile-info img {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      border: 3px solid #fff;
      object-fit: cover;
      margin-top: 10px;
      position: relative;
      z-index: 2;
    }
    #profileView .profile-info h2 {
      margin-bottom: 4px;
    }
    #profileView .profile-info p {
      color: #666;
      font-size: 0.9rem;
      max-width: 260px;
      margin: 0 auto;
    }

    /* ---------- Responsive Adjustments ---------- */
    @media (max-width: 480px) {
      .candidate-block {
        width: 100px;
      }
      .bottom-nav button {
        font-size: 0.8rem;
      }
      .candidate-block img {
        width: 70px;
        height: 70px;
      }
    }
  </style>
</head>
<body>

  <!-- Top Header -->
  <div class="app-header">
    <h1>Ecclesia IEC Prototype</h1>
  </div>

  <!-- Voting / Election Views -->
  <div id="electionView" class="view active">
    <div class="container">
      <h2>1 Current open election</h2>
      <p>Select below to get started</p>
      <div class="spacer"></div>
      <div id="electionList">
        <!-- Election blocks injected here -->
      </div>
    </div>
  </div>

  <div id="positionView" class="view">
    <div class="container">
      <h2 id="positionElectionTitle"></h2>
      <div id="positionBlock">
        <!-- Position block info injected here -->
      </div>
      <div class="position-nav">
        <button class="btn" id="skipBtn" onclick="skipPosition()">Skip</button>
        <button class="btn" id="exitElectionBtn" onclick="exitElection()">Exit</button>
      </div>
    </div>
  </div>

  <div id="reviewView" class="view">
    <div class="container">
      <h2>Your Election Choices</h2>
      <div id="reviewSummary">
        <!-- Summary injected here -->
      </div>
      <button class="btn" onclick="backToElections()">Back to Elections</button>
    </div>
  </div>

  <!-- Profile View -->
  <div id="profileView" class="view">
    <div class="container profile-info">
      <div class="avatar-wrapper">
        <div class="avatar-bg"></div>
        <!-- Example avatar placeholder -->
        <img src="https://via.placeholder.com/120" alt="User Avatar">
      </div>
      <h2>User123</h2>
      <p>Welcome to your profile (Ecco) page. Your voting rewards and avatar accessories will show up here!</p>
    </div>
  </div>

  <!-- Candidate Panel Overlay -->
  <div id="candidateOverlay" class="overlay">
    <div class="candidate-panel">
      <button class="close-panel" onclick="closeCandidatePanel()">Ã—</button>
      <img id="candidateImage" src="" alt="Candidate Image">
      <h2 id="candidateName"></h2>
      <p><strong>Manifesto:</strong> <span id="candidateManifesto"></span></p>
      <p><strong>AI Summary:</strong> <span id="candidateAISummary"></span></p>
      <div class="social-links" id="candidateSocial"></div>
      <button class="btn" onclick="voteForCandidate()">Vote for this Candidate</button>
    </div>
  </div>

  <!-- Reward Panel Overlay -->
  <div id="rewardOverlay" class="overlay">
    <div class="reward-panel">
      <h2>Congratulations!</h2>
      <p>You earned a reward for voting on this position.</p>
      <button class="btn" onclick="rewardConfirmed()">Okay</button>
    </div>
  </div>

  <!-- Bottom Navigation Bar -->
  <div class="bottom-nav">
    <button id="navVoting" class="active" onclick="showPrimaryView('electionView')">
      <!-- Simple SVG icon for Voting -->
      <svg viewBox="0 0 24 24" fill="currentColor">
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14l4-4h12c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"/>
      </svg>
      Voting
    </button>
    <button id="navProfile" onclick="showPrimaryView('profileView')">
      <!-- Simple SVG icon for Profile -->
      <svg viewBox="0 0 24 24" fill="currentColor">
        <path d="M12 12c2.7 0 5-2.3 5-5s-2.3-5-5-5-5 2.3-5 5 2.3 5 5 5zm0 2c-3.3 0-10 1.7-10 5v3h20v-3c0-3.3-6.7-5-10-5z"/>
      </svg>
      Profile
    </button>
  </div>

  <script>
    /* ----- Sample Data ----- */
    const elections = generateElectionData();

    /* ----- Global State ----- */
    let currentElection = null;
    let currentPositionIndex = 0;
    let selectedCandidate = null;

    /* ----- Initialization ----- */
    document.addEventListener("DOMContentLoaded", () => {
      renderElectionList();
    });

    /* ----- Primary View Switcher ----- */
    function showPrimaryView(viewId) {
      // Hide any subviews (position, review) if switching to main voting view
      if (viewId === 'electionView') {
        showView('electionView');
      } else if (viewId === 'profileView') {
        showView('profileView');
      }
      // Update bottom nav active state
      document.getElementById("navVoting").classList.toggle("active", viewId === 'electionView');
      document.getElementById("navProfile").classList.toggle("active", viewId === 'profileView');
    }

    /* ----- View Rendering Functions ----- */
    function renderElectionList() {
      const electionList = document.getElementById("electionList");
      electionList.innerHTML = "";
      elections.forEach(election => {
        const block = document.createElement("div");
        block.className = "election-block";
        block.onclick = () => startElection(election.id);
        block.innerHTML = `
          <h2>${election.institution}</h2>
          <p><strong>Time:</strong> ${election.timeRemaining}</p>
          <p><strong>Positions:</strong> ${election.positionsCount}</p>
          <p><strong>Reward:</strong> ${election.reward}</p>
        `;
        electionList.appendChild(block);
      });
    }

    function startElection(electionId) {
      currentElection = elections.find(e => e.id === electionId);
      currentPositionIndex = 0;
      selectedCandidate = null;
      document.getElementById("positionElectionTitle").textContent = currentElection.institution;
      showView("positionView");
      renderCurrentPosition();
    }

    function renderCurrentPosition() {
      const posContainer = document.getElementById("positionBlock");
      posContainer.innerHTML = "";
      if (currentPositionIndex >= currentElection.positions.length) {
        renderReviewSummary();
        showView("reviewView");
        return;
      }
      const position = currentElection.positions[currentPositionIndex];
      const posBlock = document.createElement("div");
      posBlock.className = "position-block";
      posBlock.innerHTML = `
        <div class="position-info">
          <h2>Position: ${position.title}</h2>
          <p>${position.info}</p>
          <a href="${position.moreInfoLink}" target="_blank">More Info</a>
        </div>
        <div class="candidates" id="candidatesContainer">
          <!-- Candidate blocks go here -->
        </div>
        <div id="voteConfirmation" style="margin-top:10px;"></div>
      `;
      posContainer.appendChild(posBlock);
      renderCandidates(position.candidates);
    }

    function renderCandidates(candidates) {
      const container = document.getElementById("candidatesContainer");
      container.innerHTML = "";
      candidates.forEach(candidate => {
        const candidateDiv = document.createElement("div");
        candidateDiv.className = "candidate-block";
        candidateDiv.onclick = () => openCandidatePanel(candidate);
        candidateDiv.innerHTML = `
          <img src="${candidate.image}" alt="${candidate.name}">
          <p>${candidate.name}</p>
          ${candidate.bestChoice ? '<div class="best-choice">â˜…</div>' : ""}
        `;
        container.appendChild(candidateDiv);
      });
    }

    /* ----- Candidate Panel Functions ----- */
    function openCandidatePanel(candidate) {
      selectedCandidate = candidate;
      document.getElementById("candidateImage").src = candidate.image;
      document.getElementById("candidateName").textContent = candidate.name;
      document.getElementById("candidateManifesto").textContent = candidate.manifesto;
      document.getElementById("candidateAISummary").textContent = candidate.aiSummary;
      const socialDiv = document.getElementById("candidateSocial");
      socialDiv.innerHTML = "";
      for (const [platform, link] of Object.entries(candidate.social)) {
        const anchor = document.createElement("a");
        anchor.href = link;
        anchor.textContent = platform;
        anchor.target = "_blank";
        socialDiv.appendChild(anchor);
      }
      document.getElementById("candidateOverlay").classList.add("active");
    }

    function closeCandidatePanel() {
      document.getElementById("candidateOverlay").classList.remove("active");
    }

    function voteForCandidate() {
      const position = currentElection.positions[currentPositionIndex];
      position.vote = selectedCandidate;
      closeCandidatePanel();
      const voteConf = document.getElementById("voteConfirmation");
      voteConf.innerHTML = `
        <p>You selected <strong>${selectedCandidate.name}</strong> for ${position.title}.</p>
        <button class="btn" onclick="confirmVote()">Confirm Vote</button>
      `;
    }

    function confirmVote() {
      document.getElementById("rewardOverlay").classList.add("active");
    }

    /* ----- Reward Panel Confirmation ----- */
    function rewardConfirmed() {
      document.getElementById("rewardOverlay").classList.remove("active");
      currentPositionIndex++;
      selectedCandidate = null;
      renderCurrentPosition();
    }

    /* ----- Skip or Exit Functions ----- */
    function skipPosition() {
      currentElection.positions[currentPositionIndex].vote = "Skipped";
      currentPositionIndex++;
      selectedCandidate = null;
      renderCurrentPosition();
    }

    function exitElection() {
      alert("Exiting election. Your progress has been saved.");
      showView("electionView");
    }

    /* ----- Review Summary ----- */
    function renderReviewSummary() {
      const reviewContainer = document.getElementById("reviewSummary");
      reviewContainer.innerHTML = "";
      currentElection.positions.forEach(position => {
        const summary = document.createElement("div");
        summary.className = "summary-block";
        summary.innerHTML = `
          <h3>${position.title}</h3>
          <p><strong>Your Choice:</strong> ${
            position.vote
              ? (typeof position.vote === "object" ? position.vote.name : position.vote)
              : "No vote"
          }</p>
        `;
        reviewContainer.appendChild(summary);
      });
    }

    function backToElections() {
      currentElection = null;
      currentPositionIndex = 0;
      selectedCandidate = null;
      showView("electionView");
    }

    /* ----- Helper: Generic View Switcher ----- */
    function showView(viewId) {
      document.querySelectorAll(".view").forEach(view => view.classList.remove("active"));
      document.getElementById(viewId).classList.add("active");
    }

    /**
 * Returns an array of 8 election objects.
 * Each election has:
 *   - an 'id'
 *   - an 'institution'
 *   - a 'timeRemaining' string
 *   - a 'positionsCount' (set to 1 here)
 *   - a 'reward'
 *   - a 'positions' array with 1 position that has 8 candidates
 */
function generateElectionData() {
  const elections = [];
  for (let i = 1; i <= 8; i++) {
    elections.push({
      id: i,
      institution: `Institution #${i}`,
      timeRemaining: getRandomTimeRemaining(),
      positionsCount: 1,
      reward: getRandomReward(),
      positions: [
        {
          id: i * 100, // arbitrary ID for the position
          title: `Position for Election #${i}`,
          info: "Lorem ipsum dolor sit amet, consectetur adipiscing elit.",
          moreInfoLink: "#",
          candidates: generateCandidates(8),
          vote: null
        }
      ]
    });
  }
  return elections;
}

/**
 * Helper function that returns an array of candidate objects.
 * Each candidate has:
 *   - an 'id'
 *   - a 'name'
 *   - an 'image'
 *   - a 'manifesto'
 *   - an 'aiSummary'
 *   - a 'social' object
 *   - a 'bestChoice' boolean (randomly assigned)
 */
function generateCandidates(count) {
  const candidates = [];
  for (let i = 1; i <= count; i++) {
    candidates.push({
      id: Math.floor(Math.random() * 100000),
      name: getRandomName(),
      image: getRandomPlaceholderImage(),
      manifesto: getRandomManifesto(),
      aiSummary: getRandomAISummary(),
      social: {
        twitter: "https://twitter.com/example",
        linkedin: "https://www.linkedin.com/in/example"
      },
      bestChoice: Math.random() < 0.3 // ~30% chance to be bestChoice
    });
  }
  return candidates;
}

/* ---------- Random Data Generators ---------- */
function getRandomName() {
  const firstNames = ["Alice", "Bob", "Carol", "David", "Eve", "Frank", "Grace", "Hank", "Irene", "Jake"];
  const lastNames = ["Johnson", "Smith", "White", "Lee", "Miller", "Brown", "Davis", "Wilson", "Garcia", "Martinez"];
  const fName = firstNames[Math.floor(Math.random() * firstNames.length)];
  const lName = lastNames[Math.floor(Math.random() * lastNames.length)];
  return `${fName} ${lName}`;
}

function getRandomPlaceholderImage() {
  // Just returns a placeholder with the candidate's name or "Candidate"
  const randomText = Math.random() < 0.5 ? "Candidate" : "VoteMe";
  return `https://via.placeholder.com/150?text=${encodeURIComponent(randomText)}`;
}

function getRandomManifesto() {
  const lines = [
    "I promise to improve community engagement and transparency.",
    "My goal is to modernize facilities and enhance student experiences.",
    "I will focus on inclusive policies and fair representation for all.",
    "We need better funding and accountability in our system.",
    "I'll bring fresh perspectives and innovative ideas to this role."
  ];
  return lines[Math.floor(Math.random() * lines.length)];
}

function getRandomAISummary() {
  const lines = [
    "Focuses on strong leadership and collaboration.",
    "Emphasizes transparency and accountability.",
    "Prioritizes community-driven initiatives.",
    "Highlights the need for innovation in governance.",
    "Supports equitable policies and resource allocation."
  ];
  return lines[Math.floor(Math.random() * lines.length)];
}

function getRandomTimeRemaining() {
  // Creates a random time window like "X days Y hrs"
  const days = Math.floor(Math.random() * 5) + 1; // 1 to 5 days
  const hrs = Math.floor(Math.random() * 24);     // 0 to 23 hours
  return `${days} day${days > 1 ? "s" : ""} ${hrs} hr${hrs !== 1 ? "s" : ""}`;
}

function getRandomReward() {
  const rewards = [
    "Free Coffee Voucher",
    "Discount at Campus Store",
    "Bonus Points for Next Semester",
    "VIP Event Access",
    "Free Meal at Cafeteria",
    "Swag Bag of Goodies",
    "Priority Parking Pass",
    "Extra Library Borrowing Privileges"
  ];
  return rewards[Math.floor(Math.random() * rewards.length)];
}
const myElections = generateElectionData();
console.log(myElections);
  </script>
</body>
</html>
