<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Election Prototype Demo - Monotone Style</title>
  <!-- Optional: Google Font for styling -->
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link 
    href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" 
    rel="stylesheet"
  >
  <style>
    /* ---------- Global Reset & Typography ---------- */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Montserrat', sans-serif;
      background: #f2f2f2;
      color: #333;
      min-height: 100vh;
      padding: 20px;
    }
    h1, h2, h3 { color: #333; }
    a { color: #2a9df4; text-decoration: none; cursor: pointer; }
    a:hover { text-decoration: underline; }

    /* ---------- Container Layout ---------- */
    .view {
      display: none;
    }
    .active { display: block; }
    .container {
      max-width: 900px;
      margin: 0 auto 20px;
      background: #ffffff;
      border-radius: 6px;
      padding: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    /* ---------- Button Styling ---------- */
    .btn {
      display: inline-block;
      padding: 10px 20px;
      margin: 5px 0;
      background: #2a9df4;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .btn:hover { background: #1c7cd6; }

    /* ---------- Election Block ---------- */
    .election-block {
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 15px;
      margin-bottom: 15px;
      cursor: pointer;
      transition: background 0.2s, transform 0.2s;
      background: #fafafa;
    }
    .election-block:hover { 
      transform: translateY(-2px); 
      background: #f0f0f0;
    }
    .election-block h2 { margin-bottom: 10px; font-weight: 700; }

    /* ---------- Position Block ---------- */
    .position-block {
      margin-bottom: 20px;
    }
    .position-info { margin-bottom: 10px; }
    .position-nav { margin-top: 10px; }
    
    /* ---------- Candidate Blocks ---------- */
    .candidates {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
    }
    .candidate-block {
      border: 1px solid #ddd;
      padding: 10px;
      border-radius: 4px;
      width: 140px;
      text-align: center;
      position: relative;
      cursor: pointer;
      transition: box-shadow 0.2s, transform 0.2s;
      background: #fff;
    }
    .candidate-block:hover { 
      box-shadow: 0 3px 8px rgba(0,0,0,0.1);
      transform: translateY(-2px);
    }
    .candidate-block img {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      margin-bottom: 8px;
      border: 1px solid #ccc;
    }
    .best-choice {
      position: absolute;
      top: 5px;
      right: 5px;
      background: #2a9df4;
      color: #fff;
      border-radius: 50%;
      padding: 3px 6px;
      font-size: 0.8rem;
      font-weight: bold;
    }

    /* ---------- Candidate Panel (Overlay) ---------- */
    .overlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.6);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 100;
    }
    .overlay.active { display: flex; }
    .candidate-panel {
      background: #fff;
      border-radius: 4px;
      padding: 20px;
      max-width: 600px;
      width: 90%;
      position: relative;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    .candidate-panel img {
      width: 100%;
      max-height: 300px;
      object-fit: cover;
      border-radius: 4px;
      margin-bottom: 15px;
    }
    .close-panel {
      position: absolute;
      top: 10px;
      right: 10px;
      background: transparent;
      border: none;
      font-size: 1.5rem;
      color: #333;
      cursor: pointer;
    }
    .social-links a {
      margin-right: 10px;
      font-size: 0.9rem;
    }

    /* ---------- Reward Panel ---------- */
    .reward-panel {
      background: #fff;
      padding: 20px;
      border-radius: 4px;
      text-align: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    /* ---------- Read-only Summary ---------- */
    .summary-block {
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 15px;
      background: #f7f7f7;
      margin-bottom: 10px;
    }

    /* ---------- Position & Navigation ---------- */
    .position-nav .btn {
      margin-right: 10px;
    }
  </style>
</head>
<body>

  <!-- Election View: List all elections -->
  <div id="electionView" class="view active container">
    <h1>Available Elections</h1>
    <div id="electionList">
      <!-- Election blocks will be injected here -->
    </div>
  </div>

  <!-- Position View: One position at a time -->
  <div id="positionView" class="view container">
    <h1 id="positionElectionTitle"></h1>
    <div id="positionBlock">
      <!-- Position block info will be injected here -->
    </div>
    <div class="position-nav">
      <button class="btn" id="skipBtn" onclick="skipPosition()">Skip Position</button>
      <button class="btn" id="exitElectionBtn" onclick="exitElection()">Exit Election</button>
    </div>
  </div>

  <!-- Candidate Panel: Full-screen overlay -->
  <div id="candidateOverlay" class="overlay">
    <div class="candidate-panel">
      <button class="close-panel" onclick="closeCandidatePanel()">×</button>
      <img id="candidateImage" src="" alt="Candidate Image">
      <h2 id="candidateName"></h2>
      <p><strong>Manifesto:</strong> <span id="candidateManifesto"></span></p>
      <p><strong>AI Summary:</strong> <span id="candidateAISummary"></span></p>
      <div class="social-links" id="candidateSocial"></div>
      <button class="btn" onclick="voteForCandidate()">Vote for this Candidate</button>
    </div>
  </div>

  <!-- Reward Panel: Modal for reward -->
  <div id="rewardOverlay" class="overlay">
    <div class="reward-panel">
      <h2>Congratulations!</h2>
      <p>You earned a reward for voting on this position.</p>
      <button class="btn" onclick="rewardConfirmed()">Okay</button>
    </div>
  </div>

  <!-- Review Summary: Read-only summary of choices (when election complete) -->
  <div id="reviewView" class="view container">
    <h1>Your Election Choices</h1>
    <div id="reviewSummary">
      <!-- Summary of positions and choices -->
    </div>
    <button class="btn" onclick="backToElections()">Back to Elections</button>
  </div>

  <script>
    /* ----- Sample Data ----- */
    const elections = [
      {
        id: 1,
        institution: "University Student Council",
        timeRemaining: "2 days 5 hrs",
        positionsCount: 2,
        reward: "Free Coffee Voucher",
        positions: [
          {
            id: 101,
            title: "President",
            info: "The President oversees all council operations.",
            moreInfoLink: "#",
            candidates: [
              {
                id: 1001,
                name: "Alice Johnson",
                image: "https://via.placeholder.com/150?text=Alice",
                manifesto: "Better campus facilities and student support.",
                aiSummary: "Focus on improved infrastructure and welfare.",
                social: { twitter: "#", linkedin: "#" },
                bestChoice: true
              },
              {
                id: 1002,
                name: "Bob Smith",
                image: "https://via.placeholder.com/150?text=Bob",
                manifesto: "Transparency and student empowerment.",
                aiSummary: "Emphasizes accountability and active participation.",
                social: { twitter: "#", linkedin: "#" },
                bestChoice: false
              }
            ],
            vote: null
          },
          {
            id: 102,
            title: "Vice President",
            info: "Supports the President and manages specific projects.",
            moreInfoLink: "#",
            candidates: [
              {
                id: 1003,
                name: "Carol White",
                image: "https://via.placeholder.com/150?text=Carol",
                manifesto: "Innovative projects for community engagement.",
                aiSummary: "Strong focus on community and innovation.",
                social: { twitter: "#", linkedin: "#" },
                bestChoice: false
              },
              {
                id: 1004,
                name: "David Lee",
                image: "https://via.placeholder.com/150?text=David",
                manifesto: "Commitment to student representation.",
                aiSummary: "Highlights dedication and representation.",
                social: { twitter: "#", linkedin: "#" },
                bestChoice: true
              }
            ],
            vote: null
          }
        ]
      },
      // Additional elections can be added here...
    ];

    /* ----- Global State ----- */
    let currentElection = null;
    let currentPositionIndex = 0;
    let selectedCandidate = null;

    /* ----- Initialization ----- */
    document.addEventListener("DOMContentLoaded", () => {
      renderElectionList();
    });

    /* ----- View Rendering Functions ----- */
    function renderElectionList() {
      const electionList = document.getElementById("electionList");
      electionList.innerHTML = "";
      elections.forEach(election => {
        const block = document.createElement("div");
        block.className = "election-block";
        block.onclick = () => startElection(election.id);
        block.innerHTML = `
          <h2>${election.institution}</h2>
          <p><strong>Time Remaining:</strong> ${election.timeRemaining}</p>
          <p><strong>Positions:</strong> ${election.positionsCount}</p>
          <p><strong>Reward:</strong> ${election.reward}</p>
        `;
        electionList.appendChild(block);
      });
    }

    function startElection(electionId) {
      currentElection = elections.find(e => e.id === electionId);
      currentPositionIndex = 0;
      selectedCandidate = null;
      document.getElementById("positionElectionTitle").textContent = currentElection.institution;
      showView("positionView");
      renderCurrentPosition();
    }

    function renderCurrentPosition() {
      const posContainer = document.getElementById("positionBlock");
      posContainer.innerHTML = "";
      if (currentPositionIndex >= currentElection.positions.length) {
        // All positions complete → review summary
        renderReviewSummary();
        showView("reviewView");
        return;
      }
      const position = currentElection.positions[currentPositionIndex];
      // Build position block
      const posBlock = document.createElement("div");
      posBlock.className = "position-block";
      posBlock.innerHTML = `
        <div class="position-info">
          <h2>Position: ${position.title}</h2>
          <p>${position.info}</p>
          <a href="${position.moreInfoLink}" target="_blank">More Info</a>
        </div>
        <div class="candidates" id="candidatesContainer">
          <!-- Candidate blocks injected here -->
        </div>
        <div id="voteConfirmation" style="margin-top:10px;"></div>
      `;
      posContainer.appendChild(posBlock);
      renderCandidates(position.candidates);
    }

    function renderCandidates(candidates) {
      const container = document.getElementById("candidatesContainer");
      container.innerHTML = "";
      candidates.forEach(candidate => {
        const candidateDiv = document.createElement("div");
        candidateDiv.className = "candidate-block";
        candidateDiv.onclick = () => openCandidatePanel(candidate);
        candidateDiv.innerHTML = `
          <img src="${candidate.image}" alt="${candidate.name}">
          <p>${candidate.name}</p>
          ${candidate.bestChoice ? '<div class="best-choice">★</div>' : ""}
        `;
        container.appendChild(candidateDiv);
      });
    }

    /* ----- Candidate Panel Functions ----- */
    function openCandidatePanel(candidate) {
      selectedCandidate = candidate;
      document.getElementById("candidateImage").src = candidate.image;
      document.getElementById("candidateName").textContent = candidate.name;
      document.getElementById("candidateManifesto").textContent = candidate.manifesto;
      document.getElementById("candidateAISummary").textContent = candidate.aiSummary;
      const socialDiv = document.getElementById("candidateSocial");
      socialDiv.innerHTML = "";
      for (const [platform, link] of Object.entries(candidate.social)) {
        const anchor = document.createElement("a");
        anchor.href = link;
        anchor.textContent = platform;
        anchor.target = "_blank";
        socialDiv.appendChild(anchor);
      }
      document.getElementById("candidateOverlay").classList.add("active");
    }

    function closeCandidatePanel() {
      document.getElementById("candidateOverlay").classList.remove("active");
    }

    function voteForCandidate() {
      const position = currentElection.positions[currentPositionIndex];
      position.vote = selectedCandidate;
      closeCandidatePanel();
      const voteConf = document.getElementById("voteConfirmation");
      voteConf.innerHTML = `<p>You selected <strong>${selectedCandidate.name}</strong> for ${position.title}.</p>
                            <button class="btn" onclick="confirmVote()">Confirm Vote</button>`;
    }

    function confirmVote() {
      document.getElementById("rewardOverlay").classList.add("active");
    }

    /* ----- Reward Panel Confirmation ----- */
    function rewardConfirmed() {
      document.getElementById("rewardOverlay").classList.remove("active");
      currentPositionIndex++;
      selectedCandidate = null;
      renderCurrentPosition();
    }

    /* ----- Skip or Exit Functions ----- */
    function skipPosition() {
      currentElection.positions[currentPositionIndex].vote = "Skipped";
      currentPositionIndex++;
      selectedCandidate = null;
      renderCurrentPosition();
    }

    function exitElection() {
      alert("Exiting election. Your progress has been saved.");
      showView("electionView");
    }

    /* ----- Review Summary ----- */
    function renderReviewSummary() {
      const reviewContainer = document.getElementById("reviewSummary");
      reviewContainer.innerHTML = "";
      currentElection.positions.forEach(position => {
        const summary = document.createElement("div");
        summary.className = "summary-block";
        summary.innerHTML = `<h3>${position.title}</h3>
                             <p><strong>Your Choice:</strong> ${position.vote ? (typeof position.vote === "object" ? position.vote.name : position.vote) : "No vote"}</p>`;
        reviewContainer.appendChild(summary);
      });
    }

    function backToElections() {
      currentElection = null;
      currentPositionIndex = 0;
      selectedCandidate = null;
      showView("electionView");
    }

    /* ----- Helper: View Switcher ----- */
    function showView(viewId) {
      document.querySelectorAll(".view").forEach(view => view.classList.remove("active"));
      document.getElementById(viewId).classList.add("active");
    }
  </script>
</body>
</html>
